<% content_for :title, "#{@product.title} - #{@store.name}" %>

<div class="space-y-8">
  <!-- Breadcrumb -->
  <div class="flex items-center space-x-2 text-sm text-slate-500">
    <%= link_to connections_root_path, class: "hover:text-slate-700" do %>
      Connections
    <% end %>
    <span>/</span>
    <%= link_to connections_store_path(@store), class: "hover:text-slate-700" do %>
      <%= @store.name %>
    <% end %>
    <span>/</span>
    <span class="text-slate-900"><%= @product.title %></span>
  </div>

  <!-- Product Header -->
  <%= react_component("ProductShowView", {
    product: {
      id: @product.id,
      title: @product.title,
      external_id: @product.external_id,
      handle: @product.handle,
      vendor: @product.vendor,
      featured_image_url: @product.featured_image_url,
      fulfilment_active: @product.fulfilment_active,
      created_at: @product.created_at,
      updated_at: @product.updated_at,
      published_at: @product.published_at
    },
    store: {
      id: @store.id,
      name: @store.name
    },
    variants: @variants.map do |variant|
      {
        id: variant.id,
        title: variant.title,
        external_variant_id: variant.external_variant_id,
        fulfilment_active: variant.fulfilment_active,
        variant_mapping: variant.variant_mapping&.as_json(
          only: [
            :id, :image_id, :image_key, :frame_sku_id, :frame_sku_code, 
            :frame_sku_title, :cx, :cy, :cw, :ch, :preview_url, :cloudinary_id,
            :image_width, :image_height
          ],
          methods: [
            :artwork_preview_thumbnail, :artwork_preview_medium, :artwork_preview_large,
            :framed_preview_thumbnail, :framed_preview_medium, :framed_preview_large
          ]
        )
      }
    end,
    variantCount: @variant_count
  }) %>

  

  <!-- Actions -->
  <div class="flex items-center space-x-4">
    <%= link_to connections_store_path(@store), 
        class: "hover:bg-slate-100 hover:text-slate-900 px-4 py-2 rounded-md text-sm font-medium transition-colors" do %>
      ‚Üê Back to <%= @store.name %>
    <% end %>
    
    <%= link_to sync_from_platform_connections_store_product_path(@store, @product),
        class: "bg-slate-900 text-slate-50 hover:bg-slate-800 px-4 py-2 rounded-md text-sm font-medium transition-colors" do %>
      Sync from <%= @store.platform.humanize %>
    <% end %>
    
    <% if @product.platform_url.present? %>
      <%= link_to @product.platform_url, target: "_blank", rel: "noopener",
          class: "bg-slate-100 text-slate-900 hover:bg-slate-200 px-4 py-2 rounded-md text-sm font-medium transition-colors inline-flex items-center space-x-2" do %>
        <span>View on <%= @store.platform.humanize %></span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
        </svg>
      <% end %>
    <% end %>
  </div>
</div>

<div style="margin-bottom:16px;">
  <h2 style="margin:0 0 8px 0;font-size:18px;color:#dc2626;">⚠️ GDPR Customer Data Request</h2>
  <p style="margin:0;color:#374151;">A customer has requested their data from one of your connected Shopify stores.</p>
</div>

<div style="background:#fef2f2;border:1px solid #fecaca;border-radius:8px;padding:16px;margin-bottom:20px;">
  <div style="font-weight:600;color:#991b1b;margin-bottom:8px;">Action Required</div>
  <p style="margin:0;color:#7f1d1d;font-size:14px;">
    You must provide the customer with any data you have stored about them within the timeframe required by GDPR regulations.
  </p>
</div>

<div style="background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin-bottom:20px;">
  <h3 style="margin:0 0 12px 0;font-size:14px;color:#111827;">Request Details</h3>
  
  <div style="margin-bottom:8px;">
    <span style="font-weight:600;color:#374151;">Shop Domain:</span>
    <span style="color:#111827;"><%= @shop_domain %></span>
  </div>
  
  <% if @customer_email.present? %>
    <div style="margin-bottom:8px;">
      <span style="font-weight:600;color:#374151;">Customer Email:</span>
      <span style="color:#111827;"><%= @customer_email %></span>
    </div>
  <% end %>
  
  <div style="margin-bottom:8px;">
    <span style="font-weight:600;color:#374151;">Customer ID:</span>
    <span style="color:#111827;"><%= @customer_id %></span>
  </div>
  
  <% if @orders_count > 0 %>
    <div style="margin-bottom:8px;">
      <span style="font-weight:600;color:#374151;">Orders Requested:</span>
      <span style="color:#111827;"><%= @orders_count %></span>
    </div>
  <% end %>
  
  <div style="margin-bottom:8px;">
    <span style="font-weight:600;color:#374151;">Timestamp:</span>
    <span style="color:#111827;"><%= @timestamp.strftime("%B %d, %Y at %I:%M %p %Z") %></span>
  </div>
</div>

<div style="background:#fffbeb;border:1px solid #fde68a;border-radius:8px;padding:16px;margin-bottom:20px;">
  <h3 style="margin:0 0 12px 0;font-size:14px;color:#78350f;">What You Need to Do</h3>
  <ol style="margin:0;padding-left:20px;color:#92400e;">
    <li style="margin-bottom:8px;">Review all data stored in your system for this customer</li>
    <li style="margin-bottom:8px;">Check for any orders, shipping addresses, or other personal information</li>
    <li style="margin-bottom:8px;">Compile the data into a readable format</li>
    <li style="margin-bottom:8px;">Send the data to the customer or shop owner as per your GDPR compliance procedure</li>
  </ol>
</div>

<% if @webhook_data.present? %>
  <details style="margin-top:20px;">
    <summary style="cursor:pointer;color:#6b7280;font-size:13px;font-weight:600;">View Raw Webhook Data</summary>
    <pre style="background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px;padding:12px;margin-top:8px;overflow-x:auto;font-size:12px;color:#374151;"><%= JSON.pretty_generate(@webhook_data) %></pre>
  </details>
<% end %>

<div style="margin-top:24px;padding-top:20px;border-top:1px solid #e5e7eb;color:#6b7280;font-size:12px;">
  <p style="margin:0;">This is an automated notification from your Framefox Connect application.</p>
</div>

